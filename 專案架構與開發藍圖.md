# Kana Tower 專案架構與開發藍圖

---

## 1. 專案架構圖

```mermaid
graph TD
  A["Kana Tower (專案根目錄)"]
  A1["app.json<br/>專案設定"]
  A2["App.tsx<br/>入口"]
  A3["package.json<br/>依賴管理"]
  A4["README.md<br/>說明文件"]
  A5["src/"]
  A6["tsconfig.json<br/>TypeScript 設定"]
  A7["babel.config.js<br/>Babel 設定"]
  A8["metro.config.js<br/>Metro 設定"]
  A9[".gitignore"]
  A10["說明.md 及其他中文文件"]

  A5a["assets/<br/>靜態資源"]
  A5b["components/<br/>共用元件"]
  A5c["constants/<br/>常數"]
  A5d["data/<br/>資料檔"]
  A5e["hooks/<br/>自訂 hook"]
  A5f["navigation/<br/>導航"]
  A5g["screens/<br/>畫面"]
  A5h["store/<br/>狀態管理"]
  A5i["types/<br/>型別"]
  A5j["utils/<br/>工具"]

  A --> A1
  A --> A2
  A --> A3
  A --> A4
  A --> A5
  A --> A6
  A --> A7
  A --> A8
  A --> A9
  A --> A10

  A5 --> A5a
  A5 --> A5b
  A5 --> A5c
  A5 --> A5d
  A5 --> A5e
  A5 --> A5f
  A5 --> A5g
  A5 --> A5h
  A5 --> A5i
  A5 --> A5j

  A5b --> B1["common/<br/>共用元件"]
  A5g --> G1["common/<br/>共用畫面"]
  A5g --> G2["game-modes/<br/>遊戲模式"]
  A5g --> G3["main/<br/>主選單、遊戲主畫面"]
  A5d --> D1["vocabulary/<br/>詞彙資料"]
```

### 主要目錄說明

- **src/assets/**：圖片、音效、字型等靜態資源
- **src/components/**：可重用的 React 元件（如 ErrorBoundary、Modal、NavBar 等）
- **src/constants/**：遊戲常數、主題設定等
- **src/data/**：遊戲資料、題庫、詞彙等
- **src/hooks/**：自訂 React hook
- **src/navigation/**：App 導航設定
- **src/screens/**：各種畫面（主選單、遊戲模式、設定等）
- **src/store/**：全域狀態管理（如 gameStore）
- **src/types/**：TypeScript 型別定義
- **src/utils/**：工具函式（如日文輸入、轉換等）

---

## 2. 專案 Roadmap（開發藍圖）

### 2.1 目前已完成/現有功能

- 主選單、遊戲主畫面
- 多種遊戲模式（如漢字方塊、長文模式、俄羅斯方塊模式）
- 遊戲資料與題庫管理
- 共用元件（彈窗、導航、錯誤邊界等）
- 狀態管理（如 gameStore）
- 靜態資源管理（圖片、音效）

### 2.2 未來擴充建議

#### 2.2.1 新模式擴充

- 建議將每個遊戲模式獨立於 `src/screens/game-modes/` 目錄下，並將共用邏輯抽離至 `src/components/common/` 或 `src/utils/`
- 新增模式時，建議：
  - 建立新畫面檔案（如 `NewModeScreen.tsx`）
  - 在 `navigation/AppNavigator.tsx` 註冊新路由
  - 若有新資料結構，於 `src/data/` 或 `src/constants/` 新增
  - 共用元件盡量抽象化，利於重用

#### 2.2.2 主題切換（Theme Switching）

- 建議將主題設定集中於 `src/constants/theme.ts`
- 可考慮使用 Context 或 Zustand/MobX 等狀態管理，實現全域主題切換
- UI 元件應盡量依賴主題變數（如顏色、字型），避免硬編碼
- 可預留多主題樣式（如 light/dark/custom）

#### 2.2.3 其他可擴充性

- 多語系支援（i18n）：可於 `src/constants/` 或新增 `src/i18n/` 管理語系檔
- 雲端同步/帳號系統：可於 `src/store/` 或新增 `src/services/` 管理 API
- 成就系統、排行榜等：可於 `src/components/` 與 `src/data/` 擴充

### 2.3 建議開發流程

1. **需求規劃**：明確新功能需求，規劃資料結構與元件劃分
2. **資料設計**：於 `src/data/` 或 `src/constants/` 新增/調整資料
3. **元件開發**：於 `src/components/` 開發可重用元件
4. **畫面開發**：於 `src/screens/` 新增/調整畫面
5. **導航整合**：於 `src/navigation/` 註冊新畫面
6. **狀態管理**：於 `src/store/` 擴充狀態
7. **主題/樣式**：於 `src/constants/theme.ts` 擴充主題
8. **測試與優化**：單元測試、UI 測試、效能優化
9. **文件維護**：於 `README.md`、`說明.md` 等文件補充說明

---

## 3. Roadmap 範例（可直接複製到 README.md）

```markdown
## Roadmap

- [x] 完成主選單與基本遊戲模式
- [x] 完成漢字方塊、長文、俄羅斯方塊模式
- [x] 基本設定與共用元件
- [ ] 新增遊戲模式（如：拼音模式、挑戰模式等）
- [ ] 實作主題切換（Light/Dark/Custom）
- [ ] 多語系支援（繁中、日文、英文）
- [ ] 雲端帳號與同步
- [ ] 成就系統與排行榜
- [ ] UI/UX 優化
- [ ] 單元測試與自動化測試
```

---

## 4. 各遊戲模式詳細說明

### 4.1 漢字模式（KanjiModeScreen）

- **玩法說明**：
  - 顯示一個或多個漢字，玩家需輸入正確的假名（平假名、片假名或混合，依設定）讀音。
  - 支援顯示詞語意思、提示、連擊計分、生命值等。
  - 遊戲結束條件：生命值歸零。
- **主要設定**：
  - 難度（easy/normal/hard）：影響初始生命值。
  - JLPT 等級（n5~n1）：決定漢字詞彙難度。
  - 讀音類型（hiragana/katakana/both）：可選平假名、片假名或混合。
  - 是否顯示意思、提示延遲秒數、是否顯示筆劃數。
- **特色**：
  - 支援多種難度與自訂化設定。
  - 連擊機制與分數加成。
  - 可擴充更多提示、動畫、進階統計。
- **擴充建議**：
  - 增加更多詞彙來源或自訂詞庫。
  - 支援語音輸入、筆劃動畫。
  - 增加排行榜、成就系統。

### 4.2 長文模式（LongTextModeScreen）

- **玩法說明**：
  - 類似打字練習，顯示一段日文長文，玩家需完整輸入正確內容。
  - 支援進度顯示、錯誤計數、連擊、分數、生命值等。
  - 遊戲結束條件：完成全文或生命值歸零。
- **主要設定**：
  - 文章長度（短篇/中篇）、是否顯示進度條。
  - 是否包含空格、標點符號、允許退格。
  - 文章類型（如新聞、小說、會話等）。
- **特色**：
  - 支援多段落、進階輸入驗證（多讀音、三段式輸入）。
  - 可自訂文章來源。
  - 適合進階日文輸入練習。
- **擴充建議**：
  - 增加文章分類、難度分級。
  - 支援自訂上傳文章。
  - 增加打字速度統計、錯誤分析。

### 4.3 俄羅斯方塊模式（TetrisModeScreen）

- **玩法說明**：
  - 方塊自動下落，每個方塊上有日文單字或漢字，玩家需在方塊落地前輸入正確假名消除方塊。
  - 隨等級提升，方塊速度加快，第5關起出現漢字方塊，第10關出現更長的漢字方塊。
  - 支援多種方塊形狀與顏色。
- **主要設定**：
  - 難度（beginner等）、單字類型（hiragana/kanji等）。
  - 方塊下落速度、加速規則。
- **特色**：
  - 結合打字與經典俄羅斯方塊玩法。
  - 支援多種方塊形狀、漢字方塊。
  - 分數、等級、連擊、星空動畫等豐富視覺效果。
- **擴充建議**：
  - 增加特殊方塊、道具、挑戰模式。
  - 支援自訂題庫、更多主題皮膚。
  - 增加多人對戰、排行榜。

--- 